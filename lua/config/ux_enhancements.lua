-- ============================================================================
-- 用户体验增强配置
-- 改善编辑体验和 UI 交互，不添加新快捷键
-- ============================================================================

-- ============================================================================
-- 命令历史和补全优化
-- ============================================================================
-- 增加命令历史记录数量，方便查看和重用之前执行的命令
vim.opt.history = 1000

-- 配置命令行补全模式
-- "longest:full" - 补全到最长公共部分，然后显示完整列表
-- "full" - 显示全部补全选项
vim.opt.wildmode = "longest:full,full"
-- 启用命令行菜单模式，方便导航补全选项
vim.opt.wildmenu = true

-- ============================================================================
-- 标签和搜索优化
-- ============================================================================
-- 显示完整的标签匹配信息，便于查看标签定义
vim.opt.showfulltag = true

-- ============================================================================
-- 命令行和状态行显示优化
-- ============================================================================
-- 在命令行显示不完整的命令，便于确认操作
vim.opt.showcmd = true
-- 在右下角显示光标位置信息（行号和列号）
vim.opt.ruler = true

-- ============================================================================
-- 补全菜单消息优化
-- ============================================================================
-- 追加 "c" 选项：不向补全菜单发送消息，避免补全时的消息闪烁
vim.opt.shortmess = vim.opt.shortmess + "c"

-- ============================================================================
-- 选区模式优化
-- ============================================================================
-- "exclusive" 模式：选区不包含选区终点，更符合直觉
vim.opt.selection = "exclusive"

-- ============================================================================
-- 退格键行为优化
-- ============================================================================
-- 配置退格键允许删除的内容
vim.opt.backspace = { "indent", "eol", "start" }
-- indent：删除自动缩进
-- eol：删除行尾字符（合并上一行）
-- start：删除插入模式开始前的文本

-- ============================================================================
-- 撤销功能优化
-- ============================================================================
-- 增加撤销级别数量，允许更多的撤销步骤
vim.opt.undolevels = 10000
-- 重新加载文件时保留撤销历史的行数
vim.opt.undoreload = 10000

-- ============================================================================
-- 括号匹配优化
-- ============================================================================
-- 括号匹配闪烁时间设为 0.1 秒（1 = 0.1s），速度快但能看到反馈
vim.opt.matchtime = 1

-- ============================================================================
-- 命令行高度优化
-- ============================================================================
-- 命令行高度为 1 行，减少占用屏幕空间
vim.opt.cmdheight = 1

-- ============================================================================
-- 平滑滚动优化：保持光标周围的可见上下文
-- ============================================================================
-- 保持光标上下方都有 5 行可见文本，提升阅读体验
vim.opt.scrolloff = 5
-- 保持光标左右方都有 5 列可见文本
vim.opt.sidescrolloff = 5

-- ============================================================================
-- Diff 模式优化：更好的代码行对比算法
-- ============================================================================
-- 追加"patience"算法：在 diff 中使用耐心算法，减少无关的变化突出
vim.opt.diffopt = vim.opt.diffopt + "algorithm:patience"
-- 追加"indent-heuristic"：根据缩进启发式改进 diff 算法
vim.opt.diffopt = vim.opt.diffopt + "indent-heuristic"

-- ============================================================================
-- 列表模式可视化：显示不可见字符
-- ============================================================================
-- 使用 :set list 命令时显示的字符映射
vim.opt.listchars = {
  eol = "↵",           -- 行尾标记
  tab = "» ",          -- 制表符标记
  trail = "·",         -- 行尾空格标记
  extends = "→",       -- 行超出屏幕右边的标记
  precedes = "←",      -- 行超出屏幕左边的标记
  nbsp = "␣",          -- 非换行空格标记
}

-- ============================================================================
-- 屏幕重绘优化
-- ============================================================================
-- 禁用懒重绘：执行宏时也实时重绘屏幕，让用户看到实时反馈
vim.opt.lazyredraw = false

-- ============================================================================
-- 鼠标和焦点优化
-- ============================================================================
-- 在所有模式下启用鼠标支持
vim.opt.mouse = "a"
-- 启用鼠标焦点跟随：移动鼠标时自动切换焦点窗口
vim.opt.mousefocus = true

-- ============================================================================
-- 虚拟编辑模式优化
-- ============================================================================
-- "block" 模式：在块选择时允许光标移到行尾之外
vim.opt.virtualedit = "block"

-- ============================================================================
-- 窗口分割方向优化
-- ============================================================================
-- 新的水平分割出现在下方（而不是上方）
vim.opt.splitbelow = true
-- 新的竖直分割出现在右侧（而不是左侧）
vim.opt.splitright = true

-- ============================================================================
-- 按键映射超时优化
-- ============================================================================
-- 启用按键映射超时
vim.opt.timeout = true
-- 映射序列超时时间为 300ms
vim.opt.timeoutlen = 300

-- ============================================================================
-- 文件变化检测
-- ============================================================================
-- 启用自动读取：当外部程序修改文件时自动重新加载
-- 检查 modifybycompile，focus 等事件
vim.opt.autoread = true

return {}
